{"version":3,"sources":["assets\\script\\gameScence\\TowerTile.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["// Learn TypeScript:\n//  - https://docs.cocos.com/creator/manual/en/scripting/typescript.html\n// Learn Attribute:\n//  - https://docs.cocos.com/creator/manual/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - https://docs.cocos.com/creator/manual/en/scripting/life-cycle-callbacks.html\n\nimport PrefabsManager from \"../manager/PrefabsManager\";\nimport RoleBase, { RoleType } from \"./RoleBase\";\n\nconst { ccclass, property } = cc._decorator;\n\n@ccclass\nexport default class TowerTile extends cc.Component {\n    private prefabsManager = PrefabsManager.getInstance();\n    private index: number = 0;\n    private monsterList: any = [];\n    private player: cc.Node = null;\n    private lock = false;\n    private playerData = null;\n\n    // LIFE-CYCLE CALLBACKS:\n\n    // onLoad () {}\n\n    start() {\n\n    }\n\n\n    //初始化塔信息\n    public initData(index: number, datas: any) {\n        this.index = index;\n       \n        if (datas && datas.length > 0) {\n            let monsterCount = 0;\n            //怪物个数,用于调整怪物位置\n            for (let i = 0; i < datas.length; i++) {\n                let data = datas[i];\n                if(data.type == \"monster\" || data.type == \"item\"){\n                    monsterCount++;\n                }\n            }\n            for (let i = 0; i < datas.length; i++) {\n                let data = datas[i];\n                if (data.prefab == null) {\n                    continue;\n                }\n                let tempNode = (data.type == 'player') ? cc.instantiate(this.prefabsManager.playerPrefabList[data.prefab]) : cc.instantiate(this.prefabsManager.monsterPrefabList[data.prefab]);\n                tempNode.y += 150;\n                // this.node\n                let role = tempNode.getComponent(RoleBase);\n\n                role.init(data);\n\n                if( monsterCount>2){\n                    tempNode.position = cc.v3((i-1) * 110, tempNode.y, 0);\n                    // tempNode.setS = 0.8;\n                    if(tempNode.name.indexOf(\"Wizard\")!=-1 \n                    || tempNode.name.indexOf(\"Bow\")!=-1\n                    || tempNode.name.indexOf(\"Shield\")!=-1\n                    || tempNode.name.indexOf(\"Sword\")!=-1\n                    || tempNode.name.indexOf(\"Vampire\")!=-1){\n                        tempNode.scaleX = -0.6;\n                        tempNode.scaleY = 0.6;\n                    }\n                }else{\n                    tempNode.position = cc.v3(i * 130, tempNode.y, 0);\n                }\n               \n\n                if (data.type == 'player') {\n                    this.playerData = data;\n                    this.player = tempNode;\n                    tempNode.position = cc.v3(-50, tempNode.y, 0);\n                    this.node.addChild(tempNode, 1, \"player\");\n                } else if (data.type == 'monster') {\n                    this.node.addChild(tempNode);\n                    this.monsterList.push(tempNode);\n                } else if (data.type == 'item') {\n                    // tempNode.position = cc.v3(i * 80, tempNode.y, 0);\n                    this.node.addChild(tempNode, 1, \"item\");\n                } else if (data.type == 'lock') {\n                    this.lock = true;\n                    tempNode.position = cc.v3(0, tempNode.y, 0);\n                    this.node.addChild(tempNode, 1, \"lock\");\n                }\n            }\n        }\n    }\n\n    public unLock() {\n        let lock = this.node.getChildByName(\"lock\");\n        if (lock) {\n            lock.removeFromParent();\n            lock.destroy();\n            this.lock = false;\n        }\n    }\n\n    public addPlayer(player) {\n        this.player = player;\n        player.position = cc.v3(0, 0, 0);//(0, this.node.y + 80, 0);\n        this.node.addChild(player,1, \"player\");\n    }\n\n    public isLock() {\n        return this.lock;\n    }\n\n    public getIndex() {\n        return this.index;\n    }\n\n    public getPlayer() {        \n        return this.player;\n    }\n\n    public getMonsters() {\n        return this.monsterList;\n    }\n\n    public getMonster() {\n        // let monster = this.monsterList.shift();\n        // if (monster) {\n        //     let monsterRole = monster.getComponent(RoleBase);\n        //     if (monsterRole.getShieldHp() > 0) {\n        //         this.monsterList.splice(0, 0, monster)\n        //     }\n        // }\n        let monster = null;\n        if(this.monsterList && this.monsterList.length>0){\n            monster = this.monsterList[0];\n        }\n        return monster;\n    }\n\n    public removeMonster(){\n        if(this.monsterList && this.monsterList.length>0){\n           this.monsterList.shift();\n        }\n    }\n\n    // public pushMonster(monster){\n    //     this.monsterList.push(monster);\n    // }\n\n    public hasMonster() {\n        return this.monsterList.length > 0;\n    }\n\n    public hasItem() {\n        return this.node.getChildByName(\"item\") != null;\n    }\n\n    public getItem() {\n        return this.node.getChildByName(\"item\");\n    }\n    public isPlayer() {\n        return this.player != null;\n    }\n\n    // update (dt) {}\n}\n"]}