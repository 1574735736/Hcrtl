{"version":3,"sources":["assets\\script\\manager\\SpineManager.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["// Learn TypeScript:\n//  - https://docs.cocos.com/creator/manual/en/scripting/typescript.html\n// Learn Attribute:\n//  - https://docs.cocos.com/creator/manual/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - https://docs.cocos.com/creator/manual/en/scripting/life-cycle-callbacks.html\n\nimport BaseInstanceClass from \"./BaseInstanceClass\";\n\nconst {ccclass, property} = cc._decorator;\n\n@ccclass\nexport default class SpineManager extends BaseInstanceClass {\n /**\n     * 播放spin动画\n     * @param animationName 动画名称\n     * @param completeCallback 播放回调\n     * @param isLoop 是否循环\n     */\n    public playSpinAnimation(spinSkeleton: sp.Skeleton, animationName: string, isLoop: boolean, completeCallback: any, self: any = null, timeScale: number = 1) {\n\n\n    // console.log('播放动画', animationName, 'spinSkeleton', spinSkeleton, isLoop)\n    spinSkeleton.setStartListener(null);\n    spinSkeleton.loop = isLoop;\n    spinSkeleton.timeScale = timeScale;\n    spinSkeleton.animation = animationName;\n    // spinSkeleton.setAnimation(0,animationName,isLoop);\n       \n      spinSkeleton.setCompleteListener(completeCallback);\n    // (completeCallback) ? : spinSkeleton.setCompleteListener(null);\n}\n\npublic loadSpine(spinSkeleton: sp.Skeleton, path: string, isLoop: boolean, skinName: string, animationName: string, completeCallback:Function = null) {\n    cc.loader.loadRes(path, sp.SkeletonData, (err, spData) => {\n        if (err) {\n            console.log(\"LoadSpin \", err)\n            return\n        }\n        spinSkeleton.skeletonData = spData;\n        spinSkeleton.defaultSkin = skinName;\n        spinSkeleton.setSkin(skinName);\n        spinSkeleton.loop = isLoop;\n        spinSkeleton.animation = animationName;\n        console.log('LoadSpin:****skinName', skinName)\n        if (completeCallback != null) {\n            completeCallback();\n        }\n        // spinSkeleton.setSkin(skinName);\n    })\n}\n\n    public loadSkinSpine(spinSkeleton: sp.Skeleton, weapon: sp.Skeleton, isLoop: boolean, skinIdx: number, weaponIdx: number, animationName: string, completeCallback: Function = null) {\n        let path = skinIdx > 1 ? \"spine/play/pifu\" : \"spine/play/zhu1\";\n        cc.loader.loadRes(path, sp.SkeletonData, (err, spData) => {\n            if (err) {\n                console.log(\"LoadSpin \", err)\n                return\n            }\n            spinSkeleton.skeletonData = spData;\n            spinSkeleton.loop = isLoop;\n            spinSkeleton.animation = animationName;\n            if (completeCallback != null) {\n                completeCallback();\n            }\n\n            this.changSpinSkin(spinSkeleton, weapon, skinIdx, weaponIdx);\n           \n        })\n    }\n\n\n    public changSpinSkin(spSkin: sp.Skeleton, weapon: sp.Skeleton, skinIdx: number, weaponIdx: number ) {\n\n        let sIdx = skinIdx - 1;\n        let sName = sIdx < 1 ? \"default\" : \"p\" + sIdx;\n\n        cc.log(\"sName     \" + sName);\n\n        spSkin.defaultSkin = sName;\n\n        spSkin.setSkin(sName);\n\n        let slot1 = spSkin.findSlot(\"wq\");\n        let slot1_2 = spSkin.findSlot(\"wq2\");\n        let slot1_3 = spSkin.findSlot(\"wq3\");\n        let slot1_4 = spSkin.findSlot(\"wq4\");\n        let slot1_5 = spSkin.findSlot(\"wq5\");\n\n        if (!slot1) {\r\n            console.log(\"slot1   is   null !!!\");\r\n        }\n\n        if (!slot1_2) {\r\n            console.log(\"slot1_2   is   null !!!\");\r\n        }\n        if (!slot1_3) {\r\n            console.log(\"slot1_3   is   null !!!\");\r\n        }\n        if (!slot1_4) {\r\n            console.log(\"slot1_4   is   null !!!\");\r\n        }\n        if (!slot1_5) {\r\n            console.log(\"slot1_5   is   null !!!\");\r\n        }\n\n        let wName = \"\";\n        if (weaponIdx > 1) {\r\n            wName = \"wq\" + weaponIdx;\r\n        }\n        else {\n            if (sIdx <= 0) {\r\n                wName = \"wq1\";\r\n            }\n            else {\n                wName = \"ypwq\" + (sIdx);\r\n            }           \n        }\n      \n        let slot2 = weapon.findSlot(wName);\n       \n        let attachment = slot2.getAttachment();\n        slot1.setAttachment(attachment);\n        if (slot1_2) {\r\n            slot1_2.setAttachment(attachment);\r\n        }\n        if (slot1_3) {\r\n            slot1_3.setAttachment(attachment);\r\n        }\n        if (slot1_4) {\r\n            slot1_4.setAttachment(attachment);\r\n        }\n        if (slot1_5) {\r\n            slot1_5.setAttachment(attachment);\r\n        }\n    }\n\npublic getAnimationName(spinSkeleton: sp.Skeleton): string {\n    return spinSkeleton.animation;\n}\n}\n"]}