{"version":3,"sources":["assets\\script\\mainScene\\WeaponShop.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["\r\nconst { ccclass, property } = cc._decorator;\r\nimport { localStorageKey, userData } from \"../data/UserData\";\r\nimport EventDefine from \"../util/EventDefine\";\r\nimport SpineManager from \"../manager/SpineManager\";\r\nimport SkinShopItemData from \"../util/SkinShopItemData\";\r\nimport WeaponItemData from \"../util/WeaponItemData\";\r\n\r\n\r\n@ccclass\r\nexport default class WeaponShop extends cc.Component {\r\n\r\n    private shop_num_gold: cc.Label = null\r\n\r\n    private showModelOfShop: sp.Skeleton;\r\n\r\n    private shopDatas: SkinShopItemData[] = null;\r\n    private weaponDatas: WeaponItemData[] = null;\r\n\r\n    private Item: cc.Node = null;\r\n    private content: cc.Node = null;\r\n    private pItems: cc.Node[] = [];\r\n\r\n    private selectPos: number = 0;\r\n\r\n    \r\n    start () {\r\n\r\n        this.shop_num_gold = cc.find(\"bg_gold/num_gold\", this.node).getComponent(cc.Label);\r\n        this.shopDatas = userData.getData(localStorageKey.SHOP_DATAS);\r\n        this.weaponDatas = userData.getData(localStorageKey.WEAPON_DATAS);\r\n\r\n        var btn_return = cc.find(\"btn_home\", this.node);\r\n        btn_return.on(EventDefine.CLICK, this.OnClosePanel, this);\r\n        this.showModelOfShop = (cc.find(\"model_using/roleModel\", this.node)).getComponent(sp.Skeleton);\r\n        this.Item = cc.find(\"Item\", this.node);\r\n        this.content = cc.find(\"ScrollView/view/content\", this.node);\r\n\r\n        this.updateShowModel();\r\n        this.UndateGlodNum();\r\n        this.updateItems();\r\n\r\n    }\r\n\r\n    UndateGlodNum() {\r\n        this.shop_num_gold.string = userData.getData(localStorageKey.GOLD);\r\n    }\r\n\r\n    OnClosePanel() {\r\n        this.node.destroy();\r\n    }\r\n\r\n    private updateShowModel(): void {\r\n        let usingIndex = userData.getData(localStorageKey.USING_SKIN_INDEX);        \r\n        let resName = this.shopDatas[usingIndex].resName;\r\n        SpineManager.getInstance().loadSpine(this.showModelOfShop, \"spine/player/\" + resName, true, \"default\", \"daiji\");\r\n    }\r\n\r\n\r\n    /**�����б�����*/\r\n    private updateItems(): void {\r\n        let rowNum = 3;\r\n\r\n        var spaceX: number = 10;\r\n        var spaceY: number = 10;\r\n        var scaleSize: number = 0.8;\r\n        var width: number = this.Item.width * scaleSize;\r\n        var height: number = this.Item.height * scaleSize;\r\n        var countY: number = \r\n            rowNum * (height + spaceY) + spaceY;\r\n        this.content.height = countY;\r\n\r\n\r\n        for (let i = 0; i < this.weaponDatas.length; i++) {\r\n            let increaseX = width + spaceX;//Ϊ��\r\n            let initPosX = -(increaseX * 3 - 10) / 2 + width / 2;\r\n            let increaseY = -(height + spaceY);//Ϊ��\r\n            let initPosY = this.content.height / 2 - (spaceY + height / 2);\r\n            let item = cc.instantiate(this.Item);\r\n            this.content.addChild(item);\r\n            let rowIndex = Math.floor(i / 3);\r\n            let columnsIndex = i % 3;\r\n            let x = initPosX + columnsIndex * increaseX;\r\n            let y = initPosY + rowIndex * increaseY;\r\n            item.setPosition(x, y);\r\n            item.setScale(scaleSize, scaleSize);\r\n            item.active = true;\r\n            item.getChildByName(\"img_SelectBg\").active = i == this.selectPos ? true : false;\r\n            this.pItems.push(item);\r\n\r\n            var text1 = cc.find(\"btn_Buy/txt_Price\", item).getComponent(cc.Label);\r\n            var text2 = cc.find(\"btn_None/txt_Price\", item).getComponent(cc.Label);\r\n\r\n            text1.string = String(this.weaponDatas[i].costNum);\r\n            text2.string = String(this.weaponDatas[i].costNum);\r\n\r\n            var use = item.getChildByName(\"btn_Use\");\r\n            var get = item.getChildByName(\"btn_Get\");\r\n            var get = item.getChildByName(\"btn_Buy\");\r\n            var get = item.getChildByName(\"btn_None\");\r\n\r\n            var icon = item.getChildByName(\"img_weapon\").getComponent(cc.Sprite);\r\n        }\r\n        \r\n    }\r\n\r\n    private OnClickSelect(index: number) {\r\n\r\n    }\r\n\r\n    private OnClickUse(index: number) {\r\n\r\n    }\r\n\r\n    private OnClickAds(index: number) {\r\n\r\n    }\r\n\r\n    private OnClickBuy(index: number) {\r\n\r\n    }\r\n  \r\n}\r\n"]}