{"version":3,"sources":["assets\\script\\mainScene\\SignInView.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAEM,IAAA,kBAAqC,EAAnC,oBAAO,EAAE,sBAA0B,CAAC;AAC5C,6CAA6D;AAC7D,iDAA4C;AAC5C,uCAAkC;AAClC,wDAAmD;AAGnD;IAAwC,8BAAY;IADpD;QAAA,qEAuIC;QAnIG,aAAO,GAAa,CAAC,IAAI,EAAE,IAAI,EAAE,CAAC,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,CAAC,CAAA;QAC3D,YAAM,GAAgB,IAAI,CAAC;QAE3B,cAAQ,GAAY,IAAI,CAAC;QA+EjB,gBAAU,GAAG,IAAI,CAAC;QAgC1B,gBAAU,GAAa,IAAI,CAAC;;IAiBhC,CAAC;IA9HG,2BAAM,GAAN;QACI,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;QACzB,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,EAAE,CAAC,OAAO,CAAC,GAAG,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;IAC/C,CAAC;IAED,0BAAK,GAAL;QAEI,IAAI,KAAK,GAAG,EAAE,CAAC,IAAI,CAAC,WAAW,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC;QAC5C,KAAK,CAAC,EAAE,CAAC,OAAO,EAAE,IAAI,CAAC,YAAY,EAAE,IAAI,CAAC,CAAC;QAE3C,IAAI,OAAO,GAAG,EAAE,CAAC,IAAI,CAAC,aAAa,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC;QAChD,OAAO,CAAC,EAAE,CAAC,OAAO,EAAE,IAAI,CAAC,cAAc,EAAE,IAAI,CAAC,CAAC;QAE/C,IAAI,MAAM,GAAG,EAAE,CAAC,IAAI,CAAC,YAAY,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC;QAC9C,MAAM,CAAC,EAAE,CAAC,OAAO,EAAE,IAAI,CAAC,aAAa,EAAE,IAAI,CAAC,CAAC;QAE7C,IAAI,CAAC,MAAM,GAAG,EAAE,CAAC,IAAI,CAAC,QAAQ,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,YAAY,CAAC,EAAE,CAAC,QAAQ,CAAC,CAAC;QAErE,mBAAQ,CAAC,OAAO,CAAC,0BAAe,CAAC,UAAU,EAAE,CAAC,CAAC,CAAC;QAChD,mBAAQ,CAAC,OAAO,CAAC,0BAAe,CAAC,WAAW,EAAE,CAAC,CAAC,CAAC;QAEjD,IAAI,CAAC,aAAa,EAAE,CAAC;IACzB,CAAC;IAED,iCAAY,GAAZ;QAAA,iBAKC;QAHG,IAAI,IAAI,GAAG,EAAE,CAAC,QAAQ,CAAC,EAAE,CAAC,OAAO,CAAC,GAAG,EAAE,CAAC,EAAE,CAAC,CAAC,EAAE,EAAE,CAAC,QAAQ,CAAC,cAAQ,KAAI,CAAC,IAAI,CAAC,OAAO,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QAC3F,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC;IAE9B,CAAC;IAED,kCAAa,GAAb;QAAA,iBAMC;QALG,IAAI,IAAI,CAAC,QAAQ,IAAI,KAAK,EAAE;YACxB,OAAO;SACV;QACD,oBAAU,CAAC,WAAW,EAAE,CAAC,eAAe,CAAC,kBAAkB,EAAE,cAAQ,KAAI,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,cAAQ,KAAI,CAAC,YAAY,EAAE,CAAC,CAAC,CAAC,CAAC,CAAA;QAC5H,IAAI,CAAC,UAAU,GAAG,cAAQ,KAAI,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;IACrD,CAAC;IAED,mCAAc,GAAd;QACI,IAAI,IAAI,CAAC,QAAQ,IAAI,KAAK,EAAE;YACxB,OAAO;SACV;QACD,IAAI,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC;IACxB,CAAC;IAED,gCAAW,GAAX,UAAY,GAAW;QACnB,IAAI,OAAO,GAAG,mBAAQ,CAAC,OAAO,CAAC,0BAAe,CAAC,UAAU,CAAC,CAAC;QAC3D,OAAO,GAAG,OAAO,GAAG,CAAC,CAAC;QACtB,IAAI,QAAQ,GAAG,IAAI,IAAI,EAAE,CAAC,kBAAkB,EAAE,CAAC;QAE/C,mBAAQ,CAAC,OAAO,CAAC,0BAAe,CAAC,UAAU,EAAE,OAAO,CAAC,CAAC;QACtD,mBAAQ,CAAC,OAAO,CAAC,0BAAe,CAAC,WAAW,EAAE,QAAQ,CAAC,CAAC;QAExD,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC;QAC/B,sBAAY,CAAC,WAAW,EAAE,CAAC,iBAAiB,CAAC,IAAI,CAAC,MAAM,EAAE,SAAS,EAAE,KAAK,CAAC,CAAC;QAE5E,IAAI,OAAO,IAAI,CAAC,EAAE;YACd,IAAI,SAAS,GAAG,mBAAQ,CAAC,OAAO,CAAC,0BAAe,CAAC,UAAU,CAAC,CAAC;YAC7D,SAAS,CAAC,CAAC,CAAC,CAAC,OAAO,GAAG,IAAI,CAAC;YAC5B,mBAAQ,CAAC,OAAO,CAAC,0BAAe,CAAC,UAAU,EAAE,SAAS,CAAC,CAAC;SAE3D;aACI,IAAI,OAAO,IAAI,CAAC,EAAE;YACnB,IAAI,SAAS,GAAG,mBAAQ,CAAC,OAAO,CAAC,0BAAe,CAAC,UAAU,CAAC,CAAC;YAC7D,IAAI,WAAW,GAAG,mBAAQ,CAAC,OAAO,CAAC,0BAAe,CAAC,YAAY,CAAC,CAAC;YACjE,SAAS,CAAC,CAAC,CAAC,CAAC,OAAO,GAAG,IAAI,CAAC;YAC5B,mBAAQ,CAAC,OAAO,CAAC,0BAAe,CAAC,UAAU,EAAE,SAAS,CAAC,CAAC;YACxD,WAAW,CAAC,CAAC,CAAC,CAAC,OAAO,GAAG,IAAI,CAAC;YAC9B,mBAAQ,CAAC,OAAO,CAAC,0BAAe,CAAC,YAAY,EAAE,WAAW,CAAC,CAAC;SAC/D;QAED,IAAI,CAAC,aAAa,EAAE,CAAC;QACrB,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,OAAO,CAAC,OAAO,GAAG,CAAC,CAAC,GAAG,GAAG,CAAC,CAAC;IAErD,CAAC;IAGM,yBAAI,GAAX,UAAY,QAAQ;QAChB,IAAI,CAAC,UAAU,GAAG,QAAQ,CAAC;IAC/B,CAAC;IAED,kCAAa,GAAb;QACI,IAAI,OAAO,GAAG,mBAAQ,CAAC,OAAO,CAAC,0BAAe,CAAC,UAAU,CAAC,CAAC;QAC3D,IAAI,QAAQ,GAAG,mBAAQ,CAAC,OAAO,CAAC,0BAAe,CAAC,WAAW,CAAC,CAAA;QAC5D,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,EAAE;YACxB,IAAI,CAAC,IAAI,OAAO,EAAE;gBACd,EAAE,CAAC,IAAI,CAAC,GAAG,GAAG,CAAC,GAAG,KAAK,GAAG,CAAC,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,MAAM,GAAG,IAAI,CAAC;aACzD;YACD,IAAI,CAAC,GAAG,CAAC,EAAE;gBACP,IAAI,GAAG,GAAG,IAAI,CAAC,OAAO,CAAC,CAAC,GAAG,CAAC,CAAC,GAAG,EAAE,CAAA;gBAClC,IAAI,IAAI,CAAC,OAAO,CAAC,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,EAAE;oBAC1B,GAAG,GAAG,MAAM,CAAC;iBAChB;gBACD,EAAE,CAAC,IAAI,CAAC,GAAG,GAAG,CAAC,GAAG,WAAW,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,YAAY,CAAC,EAAE,CAAC,KAAK,CAAC,CAAC,MAAM,GAAG,GAAG,CAAC;aACjF;SACJ;QAED,IAAI,GAAG,GAAG,IAAI,IAAI,EAAE,CAAC,kBAAkB,EAAE,CAAC,CAAA,cAAc;QAExD,IAAI,QAAQ,IAAI,GAAG,IAAI,OAAO,IAAI,CAAC,EAAE;YACjC,EAAE,CAAC,IAAI,CAAC,aAAa,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,KAAK,GAAG,IAAI,EAAE,CAAC,KAAK,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC,CAAC;YAC3E,EAAE,CAAC,IAAI,CAAC,YAAY,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,KAAK,GAAG,IAAI,EAAE,CAAC,KAAK,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC,CAAC;YAC1E,EAAE,CAAC,IAAI,CAAC,oBAAoB,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,MAAM,GAAG,KAAK,CAAC;YACxD,IAAI,CAAC,QAAQ,GAAG,KAAK,CAAC;SACzB;IAEL,CAAC;IAGO,iCAAY,GAApB;QACI,IAAI,IAAI,CAAC,UAAU,EAAE;YACjB,IAAI,IAAI,GAAG,IAAI,CAAC,UAAU,CAAA;YAC1B,eAAK,CAAC,WAAW,CAAC,IAAI,CAAC,IAAI,EAAE,cAAc,EAAE,IAAI,CAAC,CAAC;SACtD;;YAEG,eAAK,CAAC,WAAW,CAAC,IAAI,CAAC,IAAI,EAAE,cAAc,CAAC,CAAC;QACjD,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC;IAC3B,CAAC;IAED,+BAAU,GAAV,UAAW,OAAe;QACtB,IAAI,IAAI,GAAG,mBAAQ,CAAC,OAAO,CAAC,0BAAe,CAAC,IAAI,CAAC,CAAC;QAClD,IAAI,GAAG,IAAI,GAAG,OAAO,CAAC;QACtB,mBAAQ,CAAC,OAAO,CAAC,0BAAe,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;IACjD,CAAC;IApIgB,UAAU;QAD9B,OAAO;OACa,UAAU,CAsI9B;IAAD,iBAAC;CAtID,AAsIC,CAtIuC,EAAE,CAAC,SAAS,GAsInD;kBAtIoB,UAAU","file":"","sourceRoot":"/","sourcesContent":["\r\n\r\nconst { ccclass, property } = cc._decorator;\r\nimport { localStorageKey, userData } from \"../data/UserData\";\r\nimport SdkManager from \"../util/SdkManager\";\r\nimport Utils from \"../util/Utils\";\r\nimport SpineManager from \"../manager/SpineManager\";\r\n\r\n@ccclass\r\nexport default class SignInView extends cc.Component {\r\n\r\n\r\n    addCoin: number[] = [1000, 1500, 0, 2500, 3000, 3500, 3500]\r\n    caidai: sp.Skeleton = null;\r\n\r\n    canClick: boolean = true;\r\n\r\n    onLoad() {\r\n        this.node.setScale(0, 0);\r\n        this.node.runAction(cc.scaleTo(0.3, 1, 1));    \r\n    }\r\n\r\n    start() {\r\n\r\n        var close = cc.find(\"btn_close\", this.node);\r\n        close.on(\"click\", this.onClickClose, this);\r\n\r\n        var reveive = cc.find(\"btn_receive\", this.node);\r\n        reveive.on(\"click\", this.onClickReceive, this);\r\n\r\n        var double = cc.find(\"btn_double\", this.node);\r\n        double.on(\"click\", this.onClickDouble, this);\r\n\r\n        this.caidai = cc.find(\"caidai\", this.node).getComponent(sp.Skeleton);\r\n\r\n        userData.setData(localStorageKey.SIGNIN_NUM, 6);\r\n        userData.setData(localStorageKey.SIGNIN_DATA, 0);\r\n\r\n        this.InitLayerView();\r\n    }\r\n\r\n    onClickClose(): void {\r\n\r\n        var func = cc.sequence(cc.scaleTo(0.3, 0, 0), cc.callFunc(() => { this.node.destroy(); }));\r\n        this.node.runAction(func);\r\n               \r\n    }\r\n\r\n    onClickDouble() {\r\n        if (this.canClick == false) {\r\n            return;\r\n        }\r\n        SdkManager.GetInstance().JavaRewardedAds(\"gift_ad3_recelve\", () => { this.onClickSign(2); }, () => { this.noAdCallback(); })\r\n        this.m_BackFunc = () => { this.onClickSign(2); };\r\n    }\r\n\r\n    onClickReceive() {\r\n        if (this.canClick == false) {\r\n            return;\r\n        }\r\n        this.onClickSign(1);\r\n    }\r\n\r\n    onClickSign(mul: number) {\r\n        var dataNum = userData.getData(localStorageKey.SIGNIN_NUM);\r\n        dataNum = dataNum + 1;\r\n        var timedata = new Date().toLocaleDateString();\r\n\r\n        userData.setData(localStorageKey.SIGNIN_NUM, dataNum);\r\n        userData.setData(localStorageKey.SIGNIN_DATA, timedata);\r\n\r\n        this.caidai.node.active = true;\r\n        SpineManager.getInstance().playSpinAnimation(this.caidai, \"caidai2\", false);\r\n\r\n        if (dataNum == 3) {\r\n            var shopDatas = userData.getData(localStorageKey.SHOP_DATAS);\r\n            shopDatas[8].bUnlock = true;\r\n            userData.setData(localStorageKey.SHOP_DATAS, shopDatas);\r\n\r\n        }\r\n        else if (dataNum == 7) {\r\n            var shopDatas = userData.getData(localStorageKey.SHOP_DATAS);\r\n            var weaponDatas = userData.getData(localStorageKey.WEAPON_DATAS);\r\n            shopDatas[7].bUnlock = true;\r\n            userData.setData(localStorageKey.SHOP_DATAS, shopDatas);\r\n            weaponDatas[1].bUnlock = true;\r\n            userData.setData(localStorageKey.WEAPON_DATAS, weaponDatas);\r\n        }\r\n\r\n        this.InitLayerView();\r\n        this.updateGold(this.addCoin[dataNum - 1] * mul);\r\n\r\n    }\r\n\r\n    private m_Listerer = null;\r\n    public Init(listerer): void {\r\n        this.m_Listerer = listerer;\r\n    }\r\n\r\n    InitLayerView() {\r\n        var dataNum = userData.getData(localStorageKey.SIGNIN_NUM);\r\n        var timedata = userData.getData(localStorageKey.SIGNIN_DATA)\r\n        for (var i = 1; i < 8; i++) {\r\n            if (i <= dataNum) {\r\n                cc.find(\"d\" + i + \"/dd\" + i, this.node).active = true;\r\n            }\r\n            if (i < 7) {\r\n                var str = this.addCoin[i - 1] + \"\"\r\n                if (this.addCoin[i - 1] == 0) {\r\n                    str = \"skin\";\r\n                }\r\n                cc.find(\"d\" + i + \"/txt_coin\", this.node).getComponent(cc.Label).string = str;\r\n            }\r\n        }\r\n\r\n        var cos = new Date().toLocaleDateString();//Date.parse()\r\n\r\n        if (timedata == cos || dataNum == 7) {\r\n            cc.find(\"btn_receive\", this.node).color = new cc.Color(105, 105, 105, 255);\r\n            cc.find(\"btn_double\", this.node).color = new cc.Color(105, 105, 105, 255);\r\n            cc.find(\"btn_double/img_red\", this.node).active = false;\r\n            this.canClick = false;\r\n        }\r\n       \r\n    }\r\n\r\n    m_BackFunc: Function = null;\r\n    private noAdCallback(): void {\r\n        if (this.m_BackFunc) {\r\n            var func = this.m_BackFunc\r\n            Utils.showMessage(this.node, \"Ad not ready\", func);\r\n        }\r\n        else\r\n            Utils.showMessage(this.node, \"Ad not ready\");\r\n        this.m_BackFunc = null;\r\n    }\r\n\r\n    updateGold(addGold: number) {\r\n        var gold = userData.getData(localStorageKey.GOLD);\r\n        gold = gold + addGold;\r\n        userData.setData(localStorageKey.GOLD, gold);\r\n    }\r\n\r\n}\r\n"]}